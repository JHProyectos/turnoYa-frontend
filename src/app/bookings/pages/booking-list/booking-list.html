
<div class="table-container">
  <div class="table-header">
    <h2>Reservas</h2>
  </div>
  <div *ngIf="loading" class="loading-shade">
    <mat-spinner></mat-spinner>
  </div>

  <div *ngIf="!loading && dataSource.length === 0" class="no-data">
    <p>No se encontraron reservas. Â¡Ingresa tu primera reserva!</p>
  </div>

  <table mat-table [dataSource]="dataSource" *ngIf="!loading && dataSource.length > 0" class="mat-elevation-z8">
    <!-- Columna Cliente -->
    <ng-container matColumnDef="client_id">
      <th mat-header-cell *matHeaderCellDef>Cliente</th>
      <td mat-cell *matCellDef="let booking">
        <a [routerLink]="['/bookings', booking.id]" class="booking-id">
          {{booking.client_id }}
        </a>
      </td>
    </ng-container>

    <!-- Columna Servicio -->
    <ng-container matColumnDef="service_id">
      <th mat-header-cell *matHeaderCellDef>Servicio</th>
      <td mat-cell *matCellDef="let booking">{{booking.service_id }}</td>
    </ng-container>

    <!-- Columna Fecha -->
    <ng-container matColumnDef="booking_date">
      <th mat-header-cell *matHeaderCellDef>Fecha</th>
      <td mat-cell *matCellDef="let booking">{{booking.booking_date | date: 'dd/MM/yyyy' }}</td>
    </ng-container>

    <!-- Columna Hora Inicio -->
    <ng-container matColumnDef="start_time">
      <th mat-header-cell *matHeaderCellDef>Hora Inicio</th>
      <td mat-cell *matCellDef="let booking">{{booking.start_time}}
      </td>
    </ng-container>

    <!-- Columna Hora Fin -->
    <ng-container matColumnDef="end_time">
      <th mat-header-cell *matHeaderCellDef>Hora Fin</th>
      <td mat-cell *matCellDef="let booking">{{booking.end_time}}
      </td>
    </ng-container>

    <!-- Columna Estado -->
    <ng-container matColumnDef="booking_status">
      <th mat-header-cell *matHeaderCellDef>Estado</th>
      <td mat-cell *matCellDef="let booking">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Estado</mat-label>
          <mat-select
            [(ngModel)]="booking.booking_status"
            name="booking_status-{{ booking.id }}"
            required
          >
            <mat-option
              *ngFor="let s of estados"
              [value]="s"
            >
              {{ s }}
            </mat-option>
          </mat-select>
          <mat-icon matSuffix>list</mat-icon>
        </mat-form-field>
      </td>
    </ng-container>

    <!-- Columna Tratamiento -->
    <ng-container matColumnDef="treatment_id">
      <th mat-header-cell *matHeaderCellDef>Tratamientos</th>
      <td mat-cell *matCellDef="let booking">
        {{ booking.treatment_id.join(', ') }}
      </td>
    </ng-container>

    <!-- Columna Fecha Creacion -->
    <ng-container matColumnDef="created_at">
      <th mat-header-cell *matHeaderCellDef>Creado</th>
      <td mat-cell *matCellDef="let booking">
        {{ booking.created_at | date: 'dd/MM/yyyy HH:mm' }}
      </td>
    </ng-container>

    <!-- Columna Fecha Actualizacion -->
    <ng-container matColumnDef="updated_at">
      <th mat-header-cell *matHeaderCellDef>Actualizado</th>
      <td mat-cell *matCellDef="let booking">
        {{ booking.updated_at | date: 'dd/MM/yyyy HH:mm' }}
      </td>
    </ng-container>

    <!-- Columna Acciones -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Acciones</th>
      <td mat-cell *matCellDef="let booking" class="actions-cell">
        <button
          mat-icon-button
          [routerLink]="['/bookings', booking.id]"
          matTooltip="Ver detalles"
        >
          <mat-icon>visibility</mat-icon>
        </button>
        <button
          mat-icon-button
          color="primary"
          [routerLink]="['/bookings', booking.id, 'edit']"
          matTooltip="Editar"
        >
          <mat-icon>edit</mat-icon>
        </button>
        <button
          mat-icon-button
          color="warn"
          (click)="deleteBooking(booking.id!)"
          matTooltip="Eliminar"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

     Filas 
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>

  <button
    mat-raised-button
    color="accent"
    routerLink="/bookings/new"
    class="add-button"
  >
    <mat-icon>add</mat-icon>
    <span>Agregar Reserva</span>
  </button>
</div>